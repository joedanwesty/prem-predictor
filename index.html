<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Premier League 25/26 Predictor</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f0f2f5;
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        #predictor-container {
            background-color: #fff;
            padding: 20px 30px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            border: 1px solid #ddd;
        }
        h1 {
            text-align: center;
            color: #37003c;
            margin-top: 0;
            margin-bottom: 20px;
        }
        #sortable-list {
            list-style-type: none;
            padding: 0;
            margin: 0;
            width: 400px;
        }
        .team-item {
            display: flex;
            align-items: center;
            padding: 12px;
            margin: 6px 0;
            background-color: #fafafa;
            border: 1px solid #ddd;
            border-radius: 6px;
            cursor: grab;
            user-select: none;
            transition: background-color 0.2s, box-shadow 0.2s, color 0.2s;
        }
        .team-item:hover {
            background-color: #f0f0f0;
            border-color: #ccc;
        }
        .position-number {
            font-weight: bold;
            font-size: 1.1em;
            color: #6c757d;
            width: 35px;
            text-align: left;
        }
        .team-logo {
            width: 30px;
            height: 30px;
            margin-right: 15px;
            flex-shrink: 0;
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
        }
        .team-name {
            font-weight: bold;
            font-size: 1.1em;
        }
        .dragging {
            opacity: 0.7;
            background: #e7f3ff;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        #save-btn {
            margin-top: 25px;
            padding: 12px 25px;
            font-size: 16px;
            font-weight: bold;
            color: #fff;
            background-color: #00d46d;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        #save-btn:hover {
            background-color: #00b35c;
        }

        /* --- NEW: CSS FOR POSITION COLORS --- */
        .position-champion {
            background-color: #FFD700; /* Gold */
            border-color: #e5c000;
        }
        .position-cl {
            background-color: #bde0fe; /* Light Blue */
            border-color: #a8c9e2;
        }
        .position-el {
            background-color: #ffb703; /* Orange */
            border-color: #e2a200;
        }
        .position-ecl {
            background-color: #caffbf; /* Light Green */
            border-color: #b3e0a9;
        }
        .position-relegation {
            background-color: #ffb4a2; /* Light Red */
            border-color: #e39e8c;
        }
        
        /* Adjust text and number color for better contrast on colored backgrounds */
        .position-champion, .position-cl, .position-el, .position-ecl, .position-relegation {
            color: #212529;
        }
        .position-champion .position-number, .position-cl .position-number, .position-el .position-number, .position-ecl .position-number, .position-relegation .position-number {
            color: #495057;
        }

    </style>
</head>
<body>

    <div id="predictor-container">
        <h1>Premier League 25/26</h1>
        <ol id="sortable-list">
            <!-- Teams will be populated by JavaScript -->
        </ol>
    </div>

    <button id="save-btn">Save as Image</button>

    <!-- Library to convert HTML to an image -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <script>
    // --- DATA ---
    const teams = [
        { name: "Arsenal", logo: "https://upload.wikimedia.org/wikipedia/en/5/53/Arsenal_FC.svg" },
        { name: "Aston Villa", logo: "https://upload.wikimedia.org/wikipedia/ar/d/d2/Aston_Villa_FC_logo.svg" },
        { name: "Bournemouth", logo: "https://upload.wikimedia.org/wikipedia/en/e/e5/AFC_Bournemouth_%282013%29.svg" },
        { name: "Brentford", logo: "https://upload.wikimedia.org/wikipedia/en/2/2a/Brentford_FC_crest.svg" },
        { name: "Brighton & Hove Albion", logo: "https://upload.wikimedia.org/wikipedia/en/f/fd/Brighton_%26_Hove_Albion_logo.svg" },
        { name: "Burnley", logo: "https://upload.wikimedia.org/wikipedia/en/6/6d/Burnley_FC_Logo.svg" },
        { name: "Chelsea", logo: "https://upload.wikimedia.org/wikipedia/en/c/cc/Chelsea_FC.svg" },
        { name: "Crystal Palace", logo: "https://upload.wikimedia.org/wikipedia/sco/0/0c/Crystal_Palace_FC_logo.svg" },
        { name: "Everton", logo: "https://upload.wikimedia.org/wikipedia/en/7/7c/Everton_FC_logo.svg" },
        { name: "Fulham", logo: "https://upload.wikimedia.org/wikipedia/en/e/eb/Fulham_FC_%28shield%29.svg" },
        { name: "Leeds United", logo: "https://upload.wikimedia.org/wikipedia/en/5/54/Leeds_United_F.C._logo.svg" },
        { name: "Liverpool", logo: "https://upload.wikimedia.org/wikipedia/en/0/0c/Liverpool_FC.svg" },
        { name: "Manchester City", logo: "https://upload.wikimedia.org/wikipedia/en/e/eb/Manchester_City_FC_badge.svg" },
        { name: "Manchester United", logo: "https://upload.wikimedia.org/wikipedia/en/7/7a/Manchester_United_FC_crest.svg" },
        { name: "Newcastle United", logo: "https://upload.wikimedia.org/wikipedia/en/5/56/Newcastle_United_Logo.svg" },
        { name: "Nottingham Forest", logo: "https://upload.wikimedia.org/wikipedia/en/e/e5/Nottingham_Forest_F.C._logo.svg" },
        { name: "Sunderland", logo: "https://upload.wikimedia.org/wikipedia/sco/7/77/Logo_Sunderland.svg" },
        { name: "Tottenham Hotspur", logo: "https://upload.wikimedia.org/wikipedia/en/b/b4/Tottenham_Hotspur.svg" },
        { name: "West Ham United", logo: "https://upload.wikimedia.org/wikipedia/en/c/c2/West_Ham_United_FC_logo.svg" },
        { name: "Wolverhampton Wanderers", logo: "https://upload.wikimedia.org/wikipedia/en/f/fc/Wolverhampton_Wanderers.svg" }
    ].sort((a, b) => a.name.localeCompare(b.name));

    // --- SCRIPT LOGIC ---
    document.addEventListener('DOMContentLoaded', () => {
        const sortableList = document.getElementById('sortable-list');
        const saveButton = document.getElementById('save-btn');
        let draggedItem = null;

        // --- FUNCTIONS ---
        
        function initializeList() {
            teams.forEach(team => {
                const listItem = document.createElement('li');
                listItem.classList.add('team-item');
                listItem.setAttribute('draggable', 'true');
                listItem.innerHTML = `
                    <span class="position-number"></span>
                    <div class="team-logo" style="background-image: url('${team.logo}')"></div>
                    <span class="team-name">${team.name}</span>
                `;
                sortableList.appendChild(listItem);
            });
            updatePositions();
        }

        // --- UPDATED: updatePositions() now handles color-coding ---
        function updatePositions() {
            const listItems = sortableList.querySelectorAll('.team-item');
            const positionClasses = ['position-champion', 'position-cl', 'position-el', 'position-ecl', 'position-relegation'];

            listItems.forEach((item, index) => {
                // Update position number
                const positionSpan = item.querySelector('.position-number');
                positionSpan.textContent = `${index + 1}.`;

                // Reset all position-based color classes
                item.classList.remove(...positionClasses);

                // Apply the new class based on the position (index)
                const position = index + 1;
                if (position === 1) {
                    item.classList.add('position-champion');
                } else if (position >= 2 && position <= 4) {
                    item.classList.add('position-cl');
                } else if (position === 5) {
                    item.classList.add('position-el');
                } else if (position === 6) {
                    item.classList.add('position-ecl');
                } else if (position >= 18) {
                    item.classList.add('position-relegation');
                }
            });
        }

        // --- DRAG AND DROP HANDLERS ---
        function handleDragStart() {
            draggedItem = this;
            setTimeout(() => this.classList.add('dragging'), 0);
        }

        function handleDragEnd() {
            this.classList.remove('dragging');
            draggedItem = null;
        }

        function handleDragOver(e) {
            e.preventDefault();
            const afterElement = getDragAfterElement(sortableList, e.clientY);
            if (afterElement == null) {
                sortableList.appendChild(draggedItem);
            } else {
                sortableList.insertBefore(draggedItem, afterElement);
            }
            updatePositions(); // This is the key to making colors update on drag
        }

        function getDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.team-item:not(.dragging)')];
            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

        // --- SAVE IMAGE FUNCTIONALITY ---
        saveButton.addEventListener('click', () => {
            const predictorElement = document.getElementById('predictor-container');
            
            html2canvas(predictorElement, {
                useCORS: true,
                logging: false 
            }).then(canvas => {
                const image = canvas.toDataURL('image/png');
                const link = document.createElement('a');
                link.href = image;
                link.download = 'MyPremierLeaguePrediction-25-26.png';
                link.click();
            });
        });

        // --- ATTACH EVENT LISTENERS ---
        function addDragEvents() {
            const items = sortableList.querySelectorAll('.team-item');
            items.forEach(item => {
                item.addEventListener('dragstart', handleDragStart);
                item.addEventListener('dragend', handleDragEnd);
            });
        }

        sortableList.addEventListener('dragover', handleDragOver);

        // --- INITIALIZE ---
        initializeList();
        addDragEvents();
    });
    </script>
</body>
</html>